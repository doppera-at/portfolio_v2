<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doppera.at - Portfolio eines angehenden Entwicklers</title>
    <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/highlightjs/tokyo-night-light.min.css" id="highlightjs-css">

    <script src="../js/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script src="../js/jquery-3.7.1.min.js"></script>

    <link rel="stylesheet" href="../css/color-definitions.css">
    <link rel="stylesheet" href="../css/violet.css">

</head>
<body class="dvw-100 m-0 p-0">
    <div class="container-fluid m-0 p-0">


        <header>
        </header>


        <nav>
        </nav>


        <noscript>
            <div class="row">
                <div class="col-md-12 text-center" id="noscript">
                    <h2>JavaScript ist deaktiviert</h2>
                    <p>Einige Funktionen auf dieser Seite sind mit JavaScript geschrieben und funktionieren dadurch nicht.<br>Bitte aktivieren Sie JavaScript um diese Seite in vollem Umfang nutzen zu können.</p>
                </div>
            </div>
        </noscript>


        <main>
            <div class="row">
                <div class="col-md-12">
                    
                    <article>
                        <h2 lang="ja">サイズお小さくする</h2>
                        <h2 lang="de">Größe reduzieren</h2>
                        <p>Da die Bilder die von der Kamera kommen unglaublich groß sind, ergab sich eine deutlich 
                            spürbare Latenz wenn Sie in der Gallerie geöffnet worden sind. Dieses Script reduziert die 
                            Größe des Bildes anhand einer Ratio, die man spezifisch einstellen kann.<br>
                            Auch die Metadaten werden in die kleineren Versionen kopiert.
                        </p>
                        <p>
                            Folgende Einstelungsmöglichkeiten gibt es:
                            <ul>
                                <li>Festlegen eines spezifischen Ordners wohin die kleineren Versionen kopiert werden.</li>
                                <li>Die Ratio um die die Dateien verkleinert/vergrößert werden sollen</li>
                                <li>Debug output, der mittels einer Flag aktiviert werden kann.</li>
                            </ul>
                        </p>
                        <pre><code class="language-python">
# Calculation of the new size, making the smaller one have the desired size is taken from here:
# https://stackoverflow.com/questions/10607468/how-to-reduce-the-image-file-size-using-pil
# Calculation of cropping has been taken from here
# https://stackoverflow.com/questions/16646183/crop-an-image-in-the-centre-using-pil

import argparse
import logging
import sys

import numpy as np

from math import floor
from os import listdir
from pathlib import Path
from PIL import Image

parser = argparse.ArgumentParser(
    prog="create_thumbnails",
    usage="%(prog)s folder [options]",
    description="Creates thumbnails from all images within a folder, resizing and cropping them",
)
parser.add_argument('folder', help="Folder containing the images to make thumbnails")
parser.add_argument('-o', '--output', help="Output directory")
parser.add_argument('-r', '--ratio', help="Ratio to resize to, 1 being same size", default="0.5")
parser.add_argument('-v', '--verbose', help="Activate debug log output", action="store_true")

if len(sys.argv)==1:
    parser.print_help(sys.stderr)
    sys.exit(1)
args = parser.parse_args()


logging.basicConfig(format="%(asctime)s [%(levelname)-5s]: %(message)s", level=logging.INFO)
if args.verbose:
    logging.getLogger('create_thumbnails').setLevel(logging.DEBUG)
logger = logging.getLogger('create_thumbnails')


if not args.output:
    outputFolder = args.folder + "resized"
    logger.info(f"No output directory specified. Creating {outputFolder}")
else:
    outputFolder = args.output
    logger.info(f"Output folder specified: {outputFolder}")
Path(outputFolder).mkdir(parents=True, exist_ok=True)

logger.info(f"Scanning folder '{args.folder}' for images..")
image_suffixes = ['.jpg', '.JPG', '.jpeg', '.png', '.PNG']
files = [x for x in listdir(args.folder) if list(filter(x.endswith, image_suffixes)) != []]
logger.info(f"Found {len(files)} images to resize")
logger.debug(f"Files found: {files}")


for file in files:
    filePath = args.folder + file
    with Image.open(filePath) as image:
        logger.info(f"Resizing image '{file}' with a ratio of {args.ratio}")
        width, height = image.size
        logger.debug(f"  Image dimensions: {width}x{height}")

        ratio = float(args.ratio)

        newWidth = int(floor(width * ratio))
        newHeight = int(floor(height * ratio))
        logger.debug(f"  New dimensions: {newWidth}x{newHeight}")

        newImage = image.resize((newWidth, newHeight))
        logger.info(f"  Image resized to {newImage.size}")

    try:
        exif = image.info['exif']
        newImage.save(outputFolder + "/" + file, exif=exif)
    except KeyError:
        newImage.save(outputFolder + "/" + file)
</code></pre>
                    </article>


                </div>
            </div>

            <div class="row">
                <div class="col-md-12 spacer">&nbsp;</div>
            </div>

        </main>


        <footer>
        </footer>

    </div>


    <div class="content-image">
        <img src="../images/writing_letter_small.jpg" alt="Bild einer handschriftlichen Briefes mit Füllfeder" class="h-25 rounded-circle border border-primary">
    </div>
    <div class="controls m-2 p-2">
        <div class="control-item"><a href="#" onclick="toggleTheme(this)" id="toggle-dark-mode"></a></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

    <script src="../js/dark-mode-toggler.js"></script>
    <script src="../js/load-components.js"></script>

</body>
</html>